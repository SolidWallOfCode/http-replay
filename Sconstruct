from parts import *

#enable smart linking
SetOptionDefault("LINKFLAGS", ['-Wl,--copy-dt-needed-entries', '-Wl,--as-needed'])
SetOptionDefault("PACKAGE_ROOT", "/opt/oath/${PART_ROOT_NAME}/${PART_SHORT_VERSION}")
SetOptionDefault("OATH_RPM_NAME", '${RPM_PREFIX}${PART_ROOT_NAME}${PART_SHORT_VERSION}')
SetOptionDefault("INSTALL_LIB",  "#lib")
SetOptionDefault("INSTALL_BIN",  "#bin")
SetOptionDefault("INSTALL_INCLUDE",  "#include")

AddOption("--with-ssl",
          dest='with_ssl',
          nargs=1,
          type='string',
          action='store',
          metavar='DIR',
          default=None,
          help='Optional path to custom build of OpenSSL'
         )

path = GetOption("with_ssl")
Part("#lib/openssl.part", CUSTOM_PATH=path)
Part("#lib/libyaml.part",vcs_type=VcsGit(server="github.com", repository="jbeder/yaml-cpp.git", tag="yaml-cpp-0.6.2"), package_group="http-replay")
Part("swoc++/swoc++.part",vcs_type=VcsGit(server="github.com", repository="SolidWallOfCode/libswoc", tag="dev-1-0-8"), package_group="http-replay")

Part("local/parts/http-replay.part", package_group="http-replay")
Part("unit_tests/unit_tests.part")

